---
const slides = [
  { src: "/images/before1.avif", alt: "Before grill cleaning" },
  { src: "/images/after1.webp", alt: "After grill cleaning" },
  { src: "/images/before2.webp", alt: "Before cleaning grill" },
  { src: "/images/after2.avif", alt: "After cleaning grill" }
];
---

<section id="gallery" class="relative py-24 bg-white overflow-hidden">
  <div class="max-w-7xl mx-auto px-6 relative z-10">
    <h2 class="text-3xl sm:text-4xl font-extrabold text-primary mb-4">
      Before & After: Spotless Results
    </h2>
    <p class="text-lg text-gray-600 mb-12 max-w-2xl">
      From greasy and forgotten to gleaming and grill-ready — real transformations from happy Calgary clients.
    </p>

    <!-- Carrusel -->
    <div class="overflow-hidden rounded-2xl shadow-2xl border-8 border-white">
      <div class="carousel-track flex transition-transform duration-500 ease-in-out">
        {slides.concat(slides).map((slide) => ( // duplicamos para loop infinito
          <div class="carousel-slide flex-shrink-0 px-2" style="width:calc(100%/2)">
            <img src={slide.src} alt={slide.alt} class="object-cover w-full h-[300px] rounded-xl" />
          </div>
        ))}
      </div>
    </div>
  </div>

  <script type="module">
    if (typeof window !== "undefined") {
      const track = document.querySelector(".carousel-track");
      const slides = document.querySelectorAll(".carousel-slide");
      const total = slides.length;
      let index = 0;

      function moveCarousel() {
        if (!track) return;
        index++;
        track.style.transform = `translateX(-${index * 50}%)`; // 50% porque 2 imágenes visibles

        // Reinicio invisible al llegar al final
        if (index >= total / 2) {
          setTimeout(() => {
            track.style.transition = "none";
            index = 0;
            track.style.transform = `translateX(0)`;
            // Restaurar transición para siguientes movimientos
            requestAnimationFrame(() => {
              track.style.transition = "transform 0.5s linear";
            });
          }, 6000); // mismo tiempo que la transición
        }
      }

      setInterval(moveCarousel, 2000); // cambia cada 2s
    }
  </script>
</section>
